<!DOCTYPE html>
<html>
<head>
    <title>Profile</title>
</head>
<body>
    <h1>User Profile</h1>
    <form method="post" action="/profile">
        <h2>Name</h2>
        <p>{{name}}</p>

        <h2>Email</h2>
        <p>
            <input type="text" name="email" value="{{email}}" disabled>
            <a href="#" onclick="enableEdit('email')">Edit</a>
        </p>

        <h2>Phone Number</h2>
        <p>
            <input type="text" name="phone" value="{{phone_number}}" disabled>
            <a href="#" onclick="enableEdit('phone')">Edit</a>
        </p>

        <h2>Password</h2>
        <p>
            <input type="password" name="password" value="{{password}}" disabled>
            <a href="#" onclick="enableEdit('password')">Change Password</a>
        </p>

        <h2>Addresses</h2>
        <ul id="addresses">
            {% for address in addresses %}
            <li>
                <input type="text" name="address" value="{{address.address}}" disabled>
                <a href="#" onclick="enableEdit('address')">Edit</a>
                <a href="#" onclick="deleteAddress('address')">Delete</a>
            </li>
            {% endfor %}
            <li>
                <a href="#" onclick="addAddress()">Add New Address</a>
            </li>
        </ul>

        <h2>Payment Methods</h2>
        <ul id="payment-methods">
            {% for card_num in payment_methods %}
            <li>
                <input type="text" name="payment" value="{{card_num.card_num}}" disabled>
                <a href="#" onclick="enableEdit('payment')">Edit</a>
                <a href="#" onclick="deletePayment('payment')">Delete</a>
            </li>
            {% endfor %}
            <li>
                <a href="#" onclick="addPayment()">Add New Payment Method</a>
            </li>
        </ul>

        <input type="submit" value="Save Changes" style="display: none;">
    </form>

    <script>
        function enableEdit(fieldName) {
            const inputField = document.querySelector(`[name="${fieldName}"]`);
            inputField.removeAttribute("disabled");
            const saveButton = document.querySelector('input[type="submit"]');
            saveButton.style.display = 'block';
        }

        function deletePayment(fieldName) {
            const listItem = document.querySelector(`[name="${fieldName}"]`).parentNode;
            listItem.remove();
        }

        let paymentCounter = 2;

        function addPayment() {
            paymentCounter++;
            const paymentList = document.getElementById('payment-methods');
            const li = document.createElement('li');
            li.innerHTML = `
                <input type="text" name="payment${paymentCounter}" value="">
                <a href="#" onclick="enableEdit('payment${paymentCounter}')">Edit</a>
                <a href="#" onclick="deletePayment('payment${paymentCounter}')">Delete</a>
            `;
            paymentList.insertBefore(li, paymentList.querySelector('li:last-child'));
            const saveButton = document.querySelector('input[type="submit"]');
            saveButton.style.display = 'block';
        }

        function deleteAddress(fieldName) {
            const listItem = document.querySelector(`[name="${fieldName}"]`).parentNode;
            listItem.remove();
        }

        let addressCounter = 2;

        function addAddress() {
            addressCounter++;
            const addressList = document.getElementById('addresses');
            const li = document.createElement('li');
            li.innerHTML = `
                <input type="text" name="address${addressCounter}" value="">
                <a href="#" onclick="enableEdit('address${addressCounter}')">Edit</a>
                <a href="#" onclick="deleteAddress('address${addressCounter}')">Delete</a>
            `;
            addressList.insertBefore(li, addressList.querySelector('li:last-child'));
            const saveButton = document.querySelector('input[type="submit"]');
            saveButton.style.display = 'block';
        }
    </script>
</body>
</html>

