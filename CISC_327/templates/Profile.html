<!DOCTYPE html>
<html>
<head>
    <title>Profile</title>
</head>
<body>
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <ul class="flashes">
        {% for category, message in messages %}
            <li class="{{ category }}">{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}
    {% endwith %}

    <h1>User Profile</h1>
    <a href={{ url_for('homepage.homepage') }}>Back to Homepage</a>
    <form method="post" action="/profile">
        <h2>Name</h2>
        <p>{{name}}</p>

        <h2>Email</h2>
        <p>"{{email}}"</p>

        <h2>Phone Number</h2>
        <p>
            <span id="phone_number">{{ phone_number }}</span>
            <button onclick="enableEdit('phone_number')">Edit</button>
        </p>

        <h2>Password</h2>
        <p>
            <input type="password" name="password" value="{{password}}" disabled>
            <a href="#" onclick="enableEdit('password')">Change Password</a>
        </p>

        <h2>Addresses</h2>
        <ul id="addresses">
            {% for address in addresses %}
            <li>
                <input type="text" name="address" value="{{address.address}}" disabled>
                <a href="#" onclick="enableEdit('address')">Edit</a>
                <a href="#" onclick="deleteAddress('address')">Delete</a>
            </li>
            {% endfor %}
            <li>
                <a href="#" onclick="addAddress()">Add New Address</a>
            </li>
        </ul>

        <h2>Payment Methods</h2>
        <ul id="payment-methods">
            {% for card_num in payment_methods %}
            <li>
                <input type="text" name="payment" value="{{card_num.card_num}}" disabled>
                <a href="#" onclick="enableEdit('payment')">Edit</a>
                <a href="#" onclick="deletePayment('payment')">Delete</a>
            </li>
            {% endfor %}
            <li>
                <a href="#" onclick="addPayment()">Add New Payment Method</a>
            </li>
        </ul>
    </form>

        <form method="post" action="/profile" style="display: none;" id="editForm">
            <input type="hidden" name="field_to_edit" id="field_to_edit">
            <input type="text" name="phone_number" id="edit_phone_number" style="display: none;">
            <input type="password" name="new_password" id="edit_new_password" style="display: none;">
            <!-- Add fields for other information as needed -->
            <input type="submit" value="Save Changes">
        </form>

    <script>
       function enableEdit(field) {
            const editForm = document.getElementById('editForm');
            const fieldToEdit = document.getElementById('field_to_edit');

            fieldToEdit.value = field;

            if (field === 'phone_number') {
                const phoneNumber = document.getElementById('phone_number');
                const editPhoneNumber = document.getElementById('edit_phone_number');
                editPhoneNumber.value = phoneNumber.textContent.trim();
                editPhoneNumber.style.display = 'block';
            } else if (field === 'new_password') {
                const editPassword = document.getElementById('edit_new_password');
                editPassword.style.display = 'block';
            } else {
                // Handle editing of other fields here
            }

            editForm.style.display = 'block';
        }

        function deletePayment(fieldName) {
            const listItem = document.querySelector(`[name="${fieldName}"]`).parentNode;
            listItem.remove();
        }

        let paymentCounter = 2;

        function addPayment() {
            paymentCounter++;
            const paymentList = document.getElementById('payment-methods');
            const li = document.createElement('li');
            li.innerHTML = `
                <input type="text" name="payment${paymentCounter}" value="">
                <a href="#" onclick="enableEdit('payment${paymentCounter}')">Edit</a>
                <a href="#" onclick="deletePayment('payment${paymentCounter}')">Delete</a>
            `;
            paymentList.insertBefore(li, paymentList.querySelector('li:last-child'));
            const saveButton = document.querySelector('input[type="submit"]');
            saveButton.style.display = 'block';
        }

        function deleteAddress(fieldName) {
            const listItem = document.querySelector(`[name="${fieldName}"]`).parentNode;
            listItem.remove();
        }

        let addressCounter = 2;

        function addAddress() {
            addressCounter++;
            const addressList = document.getElementById('addresses');
            const li = document.createElement('li');
            li.innerHTML = `
                <input type="text" name="address${addressCounter}" value="">
                <a href="#" onclick="enableEdit('address${addressCounter}')">Edit</a>
                <a href="#" onclick="deleteAddress('address${addressCounter}')">Delete</a>
            `;
            addressList.insertBefore(li, addressList.querySelector('li:last-child'));
            const saveButton = document.querySelector('input[type="submit"]');
            saveButton.style.display = 'block';
        }
    </script>
</body>
</html>




